function(editbin)
    if(MSVC)
        add_custom_command(TARGET ${ARGV0} POST_BUILD
            COMMAND editbin.exe /NOLOGO /OSVERSION:5.0 /SUBSYSTEM:WINDOWS,${ARGV1} $<TARGET_FILE:${ARGV0}> > NUL)
    else()
    # TODO: add implementation for mingw
    endif()
endfunction()

function(copyoutput)
    add_custom_command(TARGET ${ARGV0} POST_BUILD
        COMMAND ${CMAKE_COMMAND} -E make_directory ${ARGV1})
    add_custom_command(TARGET ${ARGV0} POST_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy $<TARGET_FILE:${ARGV0}> ${ARGV1})
endfunction()

function(add_rdi)
    enable_language(ASM_MASM)
    if("${CMAKE_SYSTEM_PROCESSOR}" MATCHES "(x86_64|amd64|AMD64)")
        set(SRC_FILES ${SRC_FILES} ../../source/ReflectiveDLLInjection/dll/src/GateTrampoline64.asm PARENT_SCOPE)
    elseif("${CMAKE_SYSTEM_PROCESSOR}" MATCHES "(i386|i686)")
        set(SRC_FILES ${SRC_FILES} ../../source/ReflectiveDLLInjection/dll/src/GateTrampoline32.asm PARENT_SCOPE)
    endif()
endfunction()
